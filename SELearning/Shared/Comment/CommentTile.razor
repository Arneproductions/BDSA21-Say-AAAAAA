@using SELearning.Core.Comment

<div class="row col-lg-12 comment">
    <div class="col-lg-2 row comment-rating">
        <!--Rating section-->
        <div class="col-lg-4">
            <p class="row col-lg-12">@Comment.Rating</p>
            <p class="row col-lg-12">Rating</p>
        </div>
        <div class="col-lg-8">
            <div class="btn-group" role="group" aria-label="...">
                <button type="button" class="btn btn-default btn-lg" aria-label="Left Align" @onclick="UpVote">
                    <span class="oi oi-thumb-up"></span>
                </button>
                <button type="button" class="btn btn-default btn-lg" @onclick="DownVote">
                    <span class="oi oi-thumb-down"></span>
                </button>
            </div>
        </div>

    </div>
    <div class="col-lg-9">
        <!-- Content section -->
        <div class="row">
            <!-- Content header section -->
            <p class="col-lg-11">
                <b>@Comment.Author</b>
            </p>
            <div class="col-lg-1">
                <button type="button" class="btn btn-default btn-lg text-danger" aria-label="Left Align" @onclick="Delete">
                        <span class="oi oi-trash"></span>
                </button>
            </div>
        </div>
        <div class="row">
            <p>@Comment.Text</p>
        </div>
    </div>
</div>

@code {

    [Parameter]
    public Comment Comment { get; set; }

    [Parameter]
    public EventCallback<Comment> OnCommentDeleted { get; set; }

    private async Task Delete()
    {
        // TODO: Delete comment with api

        // TODO: Check if return code is not an error

        if(OnCommentDeleted.HasDelegate)
            await OnCommentDeleted.InvokeAsync(Comment);
    }

    private Task UpVote()
    {
        // Call up vote api

        Comment.Rating++;

        return Task.CompletedTask;
    }

    private Task DownVote() 
    {
        // Call down vote api

        Comment.Rating--;

        return Task.CompletedTask;
    }
}