@page "/AllContent"

@using Core.Section
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@using SELearning.Core.Content
@using SELearning.Shared.Content;

@inject HttpClient Http

<div class="container">
    <div class="get-quote">
        <div class="row">
            <div class="col-sm-10 col-12">
                <h1 class="left-block float-left">All Content</h1>
            </div>
            <div class="col-sm-2 col-12">
                <a class="btn btn-primary right-block float-right" href="createcontent" role="button">Add Content</a>
            </div>
        </div>
    </div>
</div>

<ContentList RetrieveContent="@RetrieveContent" />

@code {
    protected async Task<List<ContentDTO>> RetrieveContent()
    {
        List<ContentDTO> contents = new();
        
        try
        {
            var content = await Http.GetFromJsonAsync<IEnumerable<ContentDTO>>("Content");
            return content.ToList();
        }
        catch (AccessTokenNotAvailableException exception)
        {
            exception.Redirect();
        }

        return contents;
    }
}
